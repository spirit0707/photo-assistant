# Ассистент по анализу фотографий с помощью методов машинного обучения

## Описание

Интерактивная система для анализа и оценки фотографий с использованием современных методов машинного обучения и компьютерного зрения. Система автоматически оценивает технические и композиционные характеристики изображений, определяет жанр, качество и сцену, а также выдает рекомендации по улучшению снимка.

---

## Основные функции

- **Анализ технических характеристик:**
  - Яркость, контраст, насыщенность, резкость, размытие.
  - Детекция объектов (люди, животные, техника) с помощью YOLO.
  - Анализ композиции (правило третей, золотое сечение, центр).
- **Классификация жанра:**
  - ML-классификатор (RandomForest) по расширенным признакам (портрет, пейзаж, архитектура, животные, техника и др.).
- **Оценка качества фото:**
  - **Два подхода:**
    - Классический ML-регрессор (RandomForest) на признаках.
    - Сверточная нейронная сеть (CNN, ResNet18) — оценка качества напрямую по изображению.
  - В интерфейсе можно выбрать подходящий метод оценки качества.
- **Классификация сцены:**
  - Предобученная ResNet18 (Places365) для определения типа сцены (улица, интерьер, природа и др.).
- **Советы по улучшению:**
  - Генерация объяснений и рекомендаций по улучшению композиции и технических параметров.
- **Кластеризация изображений:**
  - KMeans по расширенному набору признаков, автоматические подписи кластеров.
- **Интерактивный веб-интерфейс:**
  - Streamlit: загрузка фото, анализ, рекомендации, кластеризация.

---

## Архитектура и технологии

- **Streamlit** — веб-интерфейс
- **OpenCV, Pillow, numpy** — обработка изображений
- **scikit-learn** — ML-классификация жанра и качества
- **PyTorch, torchvision** — обучение и инференс CNN для качества
- **YOLO** — детекция объектов
- **ResNet18 Places365** — классификация сцен
- **KMeans** — кластеризация

---

## Как использовать

1. Установите зависимости:
   ```
   pip install -r requirements.txt
   ```
2. Запустите приложение:
   ```
   streamlit run app.py
   ```
3. Откройте в браузере предложенный адрес (обычно http://localhost:8501).

---

## Как обучать свои модели

### Оценка качества (ML и CNN):
1. Положите фото для разметки в `data/samples/quality_samples/`.
2. Разметьте их с помощью `tools/labeling/label_quality.py` (Streamlit-интерфейс).
3. Обучите ML-регрессор:
   ```
   python tools/training/train_quality_regressor.py
   ```
4. Обучите CNN-регрессор:
   ```
   python tools/training/train_quality_cnn.py
   ```
5. Модели сохраняются в `core/ml/quality/quality_regressor.pkl` и `core/ml/quality/quality_cnn.pt`.

### Классификатор жанра:
1. Положите фото по жанрам в `data/dataset/` (по папкам).
2. Запустите обучение:
   ```
   python tools/training/train_genre_classifier.py
   ```
3. Модель сохранится в `core/ml/genre/genre_classifier.pkl`.

---

## Пример работы

1. Пользователь загружает фото или делает снимок с веб-камеры.
2. Система анализирует изображение:
   - Технические параметры (яркость, резкость, контраст, насыщенность, размытие)
   - Качество (ML и/или CNN)
   - Категории объектов (YOLO)
   - Сцена (Places365)
   - Жанр (ML)
   - Советы по композиции, позе и улучшению снимка
   - Кластеризация фото с автоматическими подписями кластеров
3. В интерфейсе можно выбрать метод оценки качества (ML или CNN).

---

## Структура проекта

```
photo-assistant/
│
├── app.py                  # Главный файл Streamlit-приложения (UI)
├── requirements.txt        # Зависимости проекта
├── README.md               # Описание и архитектура
├── yolov10n.pt             # Веса YOLO для детекции объектов
│
├── assets/                 # Статические файлы (стили)
│
├── core/
│   ├── analysis/           # Метрики, композиция, советы, эвристики, классификация сцен и жанра
│   ├── detection/          # Детекторы объектов (YOLO)
│   ├── features/           # Извлечение признаков для ML
│   ├── ml/
│   │   ├── clustering/     # Кластеризация (модель, визуализация)
│   │   ├── genre/          # Классификатор жанра (модель, инференс)
│   │   ├── quality/        # Регрессор качества (ML и CNN)
│   │   └── scene/          # Классификация сцен (инференс)
│   └── visualization/      # Визуализация результатов ML
│
├── data/
│   ├── samples/quality_samples/    # Примеры изображений для обучения/разметки качества
│   ├── labels/quality_labels.csv   # Разметка для обучения модели качества
│   ├── dataset/                    # Данные для обучения жанрового классификатора (по папкам жанров)
│   ├── resnet18_places365.pth.tar  # Веса для Places365
│   └── categories_places.txt       # Список классов сцен Places365
│
├── tools/
│   ├── training/
│   │   ├── train_quality_regressor.py    # Скрипт обучения регрессора качества (ML)
│   │   ├── train_quality_cnn.py          # Скрипт обучения CNN-регрессора качества
│   │   └── train_genre_classifier.py     # Скрипт обучения классификатора жанра
│   └── labeling/
│       └── label_quality.py              # Скрипт ручной разметки качества (Streamlit)
│
├── venv/                     # Виртуальное окружение (в .gitignore)
└── __pycache__/              # Кэш Python
```

---

## Научная и практическая ценность

- Демонстрирует применение различных методов машинного обучения для анализа изображений.
- Позволяет сравнить классические ML-подходы и современные нейросетевые методы на одной задаче.
- Может быть расширен для автоматической сортировки, отбора лучших снимков, помощи фотографам и блогерам.

---

## Используемые технологии

- **Python 3.10+**
- **Streamlit** — быстрый веб-фреймворк для ML-прототипов
- **OpenCV** — обработка изображений
- **PyTorch, torchvision** — глубокое обучение, предобученные модели
- **Ultralytics YOLO** — детекция объектов
- **MediaPipe** — анализ позы
- **Numpy** — численные вычисления
- **Pillow** — работа с изображениями
- **scikit-learn** — ML-классификация жанра и качества

---

**Проект полностью соответствует теме: "Разработка системы обработки изображений с использованием методов машинного обучения".** 